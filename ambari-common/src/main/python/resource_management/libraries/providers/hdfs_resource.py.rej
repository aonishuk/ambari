--- ambari-common/src/main/python/resource_management/libraries/providers/hdfs_resource.py
+++ ambari-common/src/main/python/resource_management/libraries/providers/hdfs_resource.py
@@ -686,7 +686,7 @@ class HdfsResourceProvider(Provider):
       path_protocol = urlparse(self.resource.target).scheme.lower()
       default_fs_protocol = urlparse(self.resource.default_fs).scheme.lower()
       
-      self.create_as_root = path_protocol == 'file' or default_fs_protocol == 'file' and path_protocol == None
+      self.create_as_root = path_protocol == 'file' or default_fs_protocol == 'file' and not path_protocol
 
       # for protocols which are different that defaultFs webhdfs will not be able to create directories
       # so for them fast-hdfs-resource.jar should be used
